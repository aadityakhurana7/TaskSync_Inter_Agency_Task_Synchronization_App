<?xml version="1.0" encoding="utf-8" ?>
<Page xmlns="http://schemas.nativescript.org/tns.xsd" navigatingTo="onNavigatingTo" class="dark">
    <ActionBar title="Construction Jobs" class="action-bar">
        <ActionItem tap="{{ logout }}" ios.position="left" android.position="actionBar">
            <Label text="Sign Out" class="text-base" />
        </ActionItem>
        <ActionItem tap="onAddJobTap" ios.position="right" 
                   android.position="actionBar"
                   visibility="{{ isAdmin ? 'visible' : 'collapsed' }}">
            <Label text="+" class="text-2xl font-bold" />
        </ActionItem>
    </ActionBar>

    <GridLayout rows="auto, *">
        <StackLayout row="0">
            <GridLayout rows="auto" columns="*, *, *" class="p-2">
                <Button text="All" tap="{{ filterAll }}" col="0" class="m-1" />
                <Button text="High Priority" tap="{{ filterHighPriority }}" col="1" class="m-1" />
                <Button text="Open" tap="{{ filterOpen }}" col="2" class="m-1" />
            </GridLayout>
        </StackLayout>

        <ListView row="1" items="{{ jobs }}" itemTap="{{ onJobTap }}" height="100%" separatorColor="transparent">
            <ListView.itemTemplate>
                <GridLayout rows="auto" class="p-2">
                    <StackLayout class="job-card">
                        <Label text="{{ title }}" class="text-lg font-bold" textWrap="true" />
                        <Label text="{{ description }}" class="text-base" textWrap="true" />
                        <GridLayout columns="auto, *" class="mt-2">
                            <Label text="{{ priority }}" col="0" class="{{ 'priority-' + priority.toLowerCase() }}" />
                            <Label text="{{ status }}" col="1" class="text-right" />
                        </GridLayout>
                        <Label text="{{ location }}" class="text-secondary mt-1" textWrap="true" />
                        <Label text="{{ 'Budget: $' + budget }}" class="text-secondary" />
                    </StackLayout>
                </GridLayout>
            </ListView.itemTemplate>
        </ListView>
    </GridLayout>
</Page>